```{r}
library(tidyverse)
```


```{r}
cancer_data <- read_csv("../data/03_dat_aug.csv")
```

```{r}
cancer_data_long <- cancer_data |>
  pivot_longer(cols = -c(ID, cancer, cancer_type_number), names_to = "gene", values_to = "expression")


cancer_data_long |> filter(cancer_type_number == 1) |> arrange(desc(expression)) |> slice(1:25)
cancer_data_long |> filter(cancer_type_number == 0) |> arrange(desc(expression)) |> slice(1:25)


heatmap <- cancer_data_long |> 
  ggplot(aes(x=gene, y=cancer, fill=expression)) +
  geom_tile() +
  scale_fill_gradient2(low = "#075AFF",
                       mid = "#FFFFCC",
                       high = "#FF0000",
                       midpoint = 50000) +
  theme(axis.text.x = element_text(angle=45, hjust = 1, size = 5),
          axis.text.y = element_text(size = 5),
          legend.position = "bottom")
# 
heatmap

```

