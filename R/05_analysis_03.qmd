	
```{r}
library(tidyverse)
library(purrr)
library(dplyr)
library(ggplot2)
library(broom)
```

```{r}

numeric_cols <- cancer_data |>
select(-c(ID, cancer))
pca_result <- PCA(numeric_cols, graph = FALSE)
cancer_data |>
bind_cols(as_tibble(pca_result$ind$coord) |>
              rename(PC1 = Dim.1, PC2 = Dim.2)) |>
  ggplot(aes(x = PC1, y = PC2, color = cancer)) +
  geom_point() +
  labs(title = "PCA of Gene Expression by Cancer Type", 
       x = "Principal Component 1", y = "Principal Component 2",
       color = "Cancer Type") +
  theme_minimal()

```

```{r}
eig_percentage <- as_tibble(pca_result$eig) |> 
  mutate(PC = as.double(row_number()))
```
```{r}
eig_percentage |>
  ggplot(aes(PC, `percentage of variance`)) +
  geom_col(fill = "#56B4E9", alpha = 0.8) +
  scale_x_continuous() +
  scale_y_continuous() +
  theme_minimal_hgrid(12)

```